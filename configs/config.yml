# ================================================
# LinuxFileWatcher 配置文件
# ================================================

# --- 1. Agent 基础设置 ---
agent:
  log_level: "debug"            # 开发环境用 debug，生产用 info
  log_file: "./lfw.log"         # 测试时输出到当前目录
  data_dir: "./data"            # 测试时使用本地目录
  # 高级日志配置 (可选)
  log_max_size: 50      # 单文件 50MB
  log_max_backups: 10   # 保留 10 个备份
  log_max_age: 7        # 只保留 7 天
  log_compress: true    # 压缩旧日志
  log_stdout: true      # 调试时开启控制台输出

# --- 2. 管理平台通信 ---
server:
  url: "https://127.0.0.1:8443" # 本地测试服务端
  ca_cert: "./certs/ca.crt"
  client_cert: "./certs/client.crt"
  client_key: "./certs/client.key"
  timeout: "10s"

# --- 3. 扫描策略 (模块一) ---
scanner:
  watch_dirs:
    - "/tmp/test_watch"         # 测试目录
  exclude_dirs:
    - "/proc"
    - "/sys"
  rate_limit: 1000
  workers: 2
  policies_path: "./policies"     # 策略文件目录

# --- 4. 安全防护 (模块五/六) ---
security:
  integrity:
    check_interval: "1m"        # 完整性自检周期
  
  netguard:
    enable: true
    check_interval: "500ms"     # 网络检测周期
    whitelist:
      - "192.168.1.5"           # 假设的运维IP
      - "10.0.0.0/8"            # 内网段